TensorFlow Version: 2.20.0
Preparing dataset...
Attempting to load training set...
Found 45710 files belonging to 3695 classes.
Using 36568 files for training.
Attempting to load validation set...
Found 45710 files belonging to 3695 classes.
Using 9142 files for validation.
Detected classes: ['2000B', '20089', '200A2', '200A4', '201A2'] and others...
Building EfficientNetB0 model...
Model: "EfficientNetB0_Custom"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer_1 (InputLayer)           │ (None, 50, 50, 3)           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ data_augmentation (Sequential)       │ (None, 50, 50, 3)           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ efficientnetb0 (Functional)          │ (None, 2, 2, 1280)          │       4,049,571 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ global_average_pooling2d             │ (None, 1280)                │               0 │
│ (GlobalAveragePooling2D)             │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 1280)                │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense (Dense)                        │ (None, 3695)                │       4,733,295 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 8,782,866 (33.50 MB)
 Trainable params: 8,740,843 (33.34 MB)
 Non-trainable params: 42,023 (164.16 KB)
Starting training...
Epoch 1/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 409s 651ms/step - accuracy: 3.5550e-04 - loss: 8.2561 - val_accuracy: 6.5631e-04 - val_loss: 8.1807 - learning_rate: 0.0010
Epoch 2/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 165s 289ms/step - accuracy: 0.0019 - loss: 7.6948 - val_accuracy: 0.0016 - val_loss: 7.7640 - learning_rate: 0.0010
Epoch 3/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 171s 298ms/step - accuracy: 0.0103 - loss: 6.5373 - val_accuracy: 0.0131 - val_loss: 6.2185 - learning_rate: 0.0010
Epoch 4/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 175s 306ms/step - accuracy: 0.0502 - loss: 5.1885 - val_accuracy: 0.0256 - val_loss: 6.2622 - learning_rate: 0.0010
Epoch 5/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 171s 299ms/step - accuracy: 0.1753 - loss: 3.7311 - val_accuracy: 0.2688 - val_loss: 3.1296 - learning_rate: 0.0010
Epoch 6/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 167s 292ms/step - accuracy: 0.4637 - loss: 2.0636 - val_accuracy: 0.6885 - val_loss: 1.1936 - learning_rate: 0.0010
Epoch 7/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 175s 307ms/step - accuracy: 0.7148 - loss: 1.0431 - val_accuracy: 0.8573 - val_loss: 0.5445 - learning_rate: 0.0010
Epoch 8/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 175s 307ms/step - accuracy: 0.8461 - loss: 0.5581 - val_accuracy: 0.9315 - val_loss: 0.2522 - learning_rate: 0.0010
Epoch 9/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 177s 309ms/step - accuracy: 0.9058 - loss: 0.3422 - val_accuracy: 0.9256 - val_loss: 0.2994 - learning_rate: 0.0010
Epoch 10/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 178s 311ms/step - accuracy: 0.9338 - loss: 0.2352 - val_accuracy: 0.9570 - val_loss: 0.1560 - learning_rate: 0.0010
Epoch 11/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 176s 308ms/step - accuracy: 0.9527 - loss: 0.1694 - val_accuracy: 0.9719 - val_loss: 0.0981 - learning_rate: 0.0010
Epoch 12/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 177s 310ms/step - accuracy: 0.9620 - loss: 0.1345 - val_accuracy: 0.9690 - val_loss: 0.1207 - learning_rate: 0.0010
Epoch 13/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 177s 309ms/step - accuracy: 0.9643 - loss: 0.1293 - val_accuracy: 0.9640 - val_loss: 0.1232 - learning_rate: 0.0010
Epoch 14/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 0s 297ms/step - accuracy: 0.9659 - loss: 0.1245  
Epoch 14: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
572/572 ━━━━━━━━━━━━━━━━━━━━ 178s 311ms/step - accuracy: 0.9635 - loss: 0.1309 - val_accuracy: 0.9685 - val_loss: 0.1184 - learning_rate: 0.0010
Epoch 15/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 293s 513ms/step - accuracy: 0.9895 - loss: 0.0423 - val_accuracy: 0.9954 - val_loss: 0.0177 - learning_rate: 5.0000e-04
Epoch 16/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 175s 306ms/step - accuracy: 0.9960 - loss: 0.0179 - val_accuracy: 0.9972 - val_loss: 0.0152 - learning_rate: 5.0000e-04
Epoch 17/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 181s 316ms/step - accuracy: 0.9957 - loss: 0.0196 - val_accuracy: 0.9950 - val_loss: 0.0216 - learning_rate: 5.0000e-04
Epoch 18/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 194s 340ms/step - accuracy: 0.9956 - loss: 0.0192 - val_accuracy: 0.9945 - val_loss: 0.0170 - learning_rate: 5.0000e-04
Epoch 19/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 0s 651ms/step - accuracy: 0.9960 - loss: 0.0181  
Epoch 19: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
572/572 ━━━━━━━━━━━━━━━━━━━━ 397s 693ms/step - accuracy: 0.9947 - loss: 0.0213 - val_accuracy: 0.9926 - val_loss: 0.0346 - learning_rate: 5.0000e-04
Epoch 20/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 254s 444ms/step - accuracy: 0.9976 - loss: 0.0116 - val_accuracy: 0.9976 - val_loss: 0.0087 - learning_rate: 2.5000e-04
Epoch 21/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 182s 319ms/step - accuracy: 0.9989 - loss: 0.0069 - val_accuracy: 0.9985 - val_loss: 0.0062 - learning_rate: 2.5000e-04
Epoch 22/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 188s 329ms/step - accuracy: 0.9990 - loss: 0.0062 - val_accuracy: 0.9979 - val_loss: 0.0090 - learning_rate: 2.5000e-04
Epoch 23/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 180s 314ms/step - accuracy: 0.9982 - loss: 0.0081 - val_accuracy: 0.9980 - val_loss: 0.0101 - learning_rate: 2.5000e-04
Epoch 24/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 0s 305ms/step - accuracy: 0.9988 - loss: 0.0061  
Epoch 24: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
572/572 ━━━━━━━━━━━━━━━━━━━━ 183s 320ms/step - accuracy: 0.9989 - loss: 0.0059 - val_accuracy: 0.9978 - val_loss: 0.0086 - learning_rate: 2.5000e-04
Epoch 25/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 186s 325ms/step - accuracy: 0.9993 - loss: 0.0036 - val_accuracy: 0.9984 - val_loss: 0.0064 - learning_rate: 1.2500e-04
Epoch 26/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 182s 319ms/step - accuracy: 0.9996 - loss: 0.0030 - val_accuracy: 0.9990 - val_loss: 0.0051 - learning_rate: 1.2500e-04
Epoch 27/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 179s 313ms/step - accuracy: 0.9997 - loss: 0.0026 - val_accuracy: 0.9986 - val_loss: 0.0048 - learning_rate: 1.2500e-04
Epoch 28/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 187s 327ms/step - accuracy: 0.9996 - loss: 0.0028 - val_accuracy: 0.9988 - val_loss: 0.0051 - learning_rate: 1.2500e-04
Epoch 29/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 218s 380ms/step - accuracy: 0.9996 - loss: 0.0028 - val_accuracy: 0.9981 - val_loss: 0.0068 - learning_rate: 1.2500e-04
Epoch 30/30
572/572 ━━━━━━━━━━━━━━━━━━━━ 0s 657ms/step - accuracy: 0.9996 - loss: 0.0027      
Epoch 30: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
572/572 ━━━━━━━━━━━━━━━━━━━━ 397s 694ms/step - accuracy: 0.9996 - loss: 0.0025 - val_accuracy: 0.9985 - val_loss: 0.0058 - learning_rate: 1.2500e-04
Restoring model weights from the end of the best epoch: 27.
